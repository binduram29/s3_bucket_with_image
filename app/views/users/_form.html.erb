<%= form_with(model: user, local: true) do |form| %>
  <% if user.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(user.errors.count, "error") %> prohibited this user from being saved:</h2>

      <ul>
      <% user.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :name %>
    <%= form.text_field :name %>
  </div>

  <div class="field">
    <%= form.label :email %>
    <%= form.text_field :email %>
  </div>

   <div class="field">
    <%= form.label :avatar %><br />
    <%= form.file_field :avatar, :id=>"imgInp" %>
  </div>
  <div id='img_contain'><img id="blah" align='middle' src="http://www.clker.com/cliparts/c/W/h/n/P/W/generic-image-file-icon-hi.png" alt="your image" title=''/></div>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>
<style>
body{
  background-color:#add8e6;
  
}
#img_contain{
  border:1px solid grey;
  margin-top:10px;
  width:520px;
  
}

#imgInp{
  margin-left:7px;
  padding:10px;
  background-color:gray;
  
}
#blah{
  height:320px;
  width:auto;
  display:block;
  margin-left: auto;
   margin-right: auto;
  padding:5px;
}
</style>
<script language="javascript" type="text/javascript">
$(document).ready(function(){
  function readURL(input) {

  if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function(e) {
      $('#blah').attr('src', e.target.result);

      $('#blah').hide();
      $('#blah').fadeIn(650);

    }

    reader.readAsDataURL(input.files[0]);
  }
}

$("#imgInp").change(function() {
  readURL(this);
});
});
</script></head>
</script>
